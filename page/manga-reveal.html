<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:ital,wght@0,400;0,700;1,400;1,700&family=Inter:wght@100..900&family=JetBrains+Mono:ital,wght@0,100;0,300;0,400;0,500;1,100;1,200;1,300;1,400;1,500&family=Plus+Jakarta+Sans:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;1,100;1,200;1,300;1,400;1,500&family=Quicksand:wght@300;400;500&family=Raleway:ital,wght@0,200;0,300;0,400;0,500;0,600;1,200;1,300;1,400;1,500;1,600&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;1,100;1,300;1,400;1,500&family=Rubik:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <title>Manga View</title>
  <style>*{margin:0;padding:0;font-family:"Balsamiq Sans",system-ui}body,html{background-color:--BACKGROUND;color:--COLORTEXT}.boxloading{width:100%;height:100vh;display:flex;align-items:center;justify-content:center}.boxloading_container{width:100%;max-width:280px}.boxloading_container h3{font-size:1.4rem;text-align:center;margin-bottom:12px}.boxloading_container p{margin-bottom:20px;text-align:center}.boxloading_container_barbox{width:100%;height:4px;overflow:hidden;border-radius:6px;background:#e7e7e7}.boxloading_container_bar{width:100%;height:4px;background:#0004ff;animation:animatebarloading .8s infinite ease}@keyframes animatebarloading{0%{margin-left:-100%}100%{margin-left:200%}}img{width:100%;margin:0;padding:0;}.contentcontainer{width:100%;display:flex;flex-wrap:wrap;}
    .btn-next {
      position: sticky;
      bottom: 0;
      left: 0;
    }
    .btn-next .contentcontainer {
      display: flex;
      justify-content: flex-end;
      padding-right: 20px;
    }
    .btn-next .contentcontainer a {
      width: 20px;
      height: 20px;
      background-color: #0004ff;
      color: white;
      border-radius: 50%;
      box-shadow: rgba(0,0,0,0.2) 0px 4px 0px;
    }
  </style>
</head>
<body>
  <div class="contentcontainer" id="readly">
    <div class="boxloading">
      <div class="boxloading_container">
        <h3>Loading Fetching...</h3>
        <p>Take a few second or minute</p>
        <div class="boxloading_container_barbox">
          <div class="boxloading_container_bar"></div>
        </div>
      </div>
    </div>
  </div>
  <script>
    const a = new URLSearchParams(location.search)
    const b = a.get("response")
    if(b) {
      const createCss = document.createElement("style")
      createCss.innerText = `@media only screen and (min-width: ${b}) {.contentcontainer{width:100%;max-width:${b};margin:auto;}}`
      document.querySelector('head').append(createCss)
    }
    const hosted = '$HOSTED'
    const read = '$SLUGREAD'
    const url = `${location.origin}/${hosted}/manga/${read}/read?next=${a.get("next")||""}`
    async function fetching() {
      try {
        const datafetch = await fetch(url)
        const datajson = await datafetch.json()
        document.querySelector('.boxloading').style.display = "none"
        console.log(datajson)
        if(typeof datajson?.data?.image != "object" || !Array.isArray(datajson?.data?.image)) {
          return;
        }
        const urlList = datajson.data.image
        const box = document.getElementById('readly')
        for(let i in urlList) {
          const img = document.createElement("img")
          img.src = urlList[i]
          console.log(Number(i) - 4, Number(i))
          if(urlList.length - 4 == Number(i) && a.get("btnnext") && !datajson.data.islast) {
            // const createDocs = document.createElement("div")
            // createDocs.className = "btn-next"
            // const paramsURL = new URLSearchParams(location.search)
            // paramsURL.append("next", Number(paramsURL.get("next"))+1)
            // const buildURLNext = `${location.origin}${location.pathname}?${paramsURL.toString()}`
            // createDocs.innerHTML = `<div class="contentcontainer"><a href="${buildURLNext}"><span class="material-symbols-outlined">arrow_forward</span></a></div>`
            // box.appendChild(createDocs)
          }
          box.appendChild(img)
        }
      } catch(err) {
        document.querySelector('.boxloading').style.display = "none"
      }
    }
    fetching()
  </script>
</body>
</html>